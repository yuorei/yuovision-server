FROM golang:1.24-bookworm

# Install Air for hot reloading
RUN go install github.com/cosmtrek/air@latest

WORKDIR /app

# Install dependencies
COPY go.mod go.sum ./
RUN go mod download

# Copy source code (will be overridden by volume mount)
COPY . .

# Create config directory
RUN mkdir -p /app/config

EXPOSE 8080

ENV TZ=Asia/Tokyo
ENV HTTP_PORT=8080
ENV GOCACHE=/tmp/.cache

# Air configuration will be mounted via volume

CMD ["air", "-c", ".air.toml"]